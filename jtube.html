 <!DOCTYPE html>
 <html>
   <head>
     <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
     <title>jTube</title>
     <link rel="shortcut icon" type="image/png">
   </head>
   <body style="background-color:#333333; color:#ffffff;">
    
     <div style="font-size:20px">
       jTube by Steve Amor<br /><br />
     </div>
     <div class="wrapper" style="font-size:20px;">
      <div class="status" style="float: left;">fetching tube data....</div>
      <div class="line" style="float: left; margin-left:10px;"></div>
     </div>
     <div class="time" style="clear: left; font-size:20px;"></div>
     
     <script>
       setInterval(function() {
         $.getJSON("https://api.tfl.gov.uk/line/mode/tube/status", function(tubeData) {
           $(".line").empty();
           $(".status").empty();
           var worstStatus = 10;
           var i;
           for(i=0; i<tubeData.length; i++) {
             $(".line").append(tubeData[i].name + "<br />");
             var lineStatus = tubeData[i].lineStatuses[0].statusSeverity;
             $(".status").append(lineStatusColour(lineStatus) + "<br />");
             if(lineStatus < worstStatus) {
               worstStatus = lineStatus;
             }
           }
           updateFaviconColour(worstStatus);
         });
         updateTimeStamp();
       }, 5000);
 
       function updateTimeStamp() {
         var timeNow = new Date().toLocaleString();
         $(".time").html("<br />" + timeNow);
       }
 
       function updateFaviconColour(severity) {
         var colour = "green";
         if(severity < 7) {
           colour = "red";
         }
         else if(severity < 9) {
           colour = "orange";
         }
         var favicon = document.querySelector('link[rel="shortcut icon"]');
         favicon.setAttribute('href', "https://github.com/SteveAmor/cheerlights/raw/master/browser/" + colour + ".png");
       }
       
       function lineStatusColour(severity) {
         var colour = 'darkgreen';
         if(severity < 7) {
           colour = 'red';
         }
         else if(severity < 9) {
           colour = 'orange';
         }
         var style = "style='border-radius:35%; background-color:" + colour + "';";
         var status = "<span " + style + ">&nbsp&nbsp&nbsp&nbsp;</span>";
         return status;
       }
     </script>
   </body>
 </html>
